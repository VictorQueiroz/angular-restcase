/**
 * angular-restcase - 
 * @version v0.0.33
 * @link https://github.com/VictorQueiroz/angular-restcase
 * @license MIT
 */
!function(){"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="victorqueiroz.ngRestcase")}(),function(e){function t(e){return e.toUpperCase()}function r(){function r(r,o){function s(e){return"{"+e+"}"}function d(e,t,r){function i(e){return function(t){var r=t;return e.split(".").forEach(function(e){_.isUndefined(r)||(r=_.isUndefined(r[e])?void 0:r[e])}),r}}return function(t,r){var o={crop:!0};if(_.isUndefined(r)&&(r={}),!_.isString(e))throw new Error("Url must be a string");r=_.extend({},o,r);var d=e,a=e.match(n),u=a?a.map(function(e){var t=/[\{\}]/g;return e.replace(t,"")}):[];return _.forEach(u,function(e){var r=i(e);r(t)&&(d=d.replace(s(e),r(t)))}),r.crop&&_.forEach(u,function(e){var r=t[e];(_.isUndefined(r)||_.isEmpty(r))&&(d=d.replace(s(e),""))}),d=d.replace(/(\/)+$/,"")}}var a={},u=Restcase.Model,c=Restcase.Collection;return _.extend(c.prototype,Restcase.Events,i.collection),_.extend(u.prototype,Restcase.Events,i.model,{belongsTo:function(e,t){var r=this._relation(e,t);return new r},hasMany:function(e,t){var r=this._relation(e,t);return new r},_relation:function(e,t){if(_.isString(t)){var r=t;t={url:r}}if(_.isUndefined(t.url))throw new Error("You must specify an url");var n={modelId:this.get(this.idAttribute)};_.isUndefined(t.locals)||_.extend(n,t.locals);var i=e.extend({url:d(t.url)(n,{crop:!1})});return i},initialize:function(){var n=this,i=this.attributes;_.isFunction(this.url)&&this.url.apply(this),_.forEach(this.methods,function(o,s){var a={method:"GET",data:{},headers:{}};_.extend(a,o),this[s]=function(u,c){var l,f="save"===s,h=n.isNew();return _.isUndefined(c)&&(c={}),!f||h&&c.patch!==!0||(a.method="PATCH"),a.method=t(a.method),e.isDefined(o.url)?l=o.url:e.isDefined(n.url)&&(l=n.url),a.url=d(l)(i),"POST"===a.method?_.extend(a.data,this.attributes):("PATCH"===a.method||"PUT"===a.method)&&e.isDefined(u)&&_.extend(a.data,u),_.isObject(o.headers)&&_.extend(a.headers,o.headers),r(a).then(function(e){return e.data}).then(function(e){return _.isArray(e)||"fetch"!==s&&"save"!==s?(_.isArray(e)&&(e=e.map(function(e){var t=n.clone();return t.set(e),t})),e):(_.isObject(e)&&!_.isUndefined(e[n.idAttribute])&&n.set(e),n)})}},this)}}),a.Model=u,a.Collection=c,a.resolve=d,a}if(_.isUndefined(_))throw new Error("You must load underscore/lodash before load this module, aborting");if(_.isUndefined(Restcase))throw new Error("You must load Restcase before load this module, aborting");this.$get=r;var i=this.defaults={};this.defaults.model={idAttribute:"id",url:"",methods:{fetch:{method:"GET"},destroy:{method:"DELETE"},save:{method:"POST"}}},this.defaults.collection={},r.$inject=["$http","$parse"]}var n=/(?:\{)([^\/]*)+(?:\})/g;e.module("victorqueiroz.ngRestcase",[]).provider("$restcase",r)}(angular);