/**
 * angular-restcase - 
 * @version v0.0.32
 * @link https://github.com/VictorQueiroz/angular-restcase
 * @license MIT
 */
(function () {
function toLowerCase(e){return e.toLowerCase()}function toUpperCase(e){return e.toUpperCase()}function $RestcaseProvider(){function e(e,r){function n(e){return"{"+e+"}"}function i(e,t,r){function i(e){return function(t){var r=t;return e.split(".").forEach(function(e){_.isUndefined(r)||(r=_.isUndefined(r[e])?void 0:r[e])}),r}}return function(t,r){var o={crop:!0};if(_.isUndefined(r)&&(r={}),!_.isString(e))throw new Error("Url must be a string");r=_.extend({},o,r);var s=e,a=e.match(url_resolve_regexp),d=a?a.map(function(e){var t=/[\{\}]/g;return e.replace(t,"")}):[];return _.forEach(d,function(e){var r=i(e);r(t)&&(s=s.replace(n(e),r(t)))}),r.crop&&_.forEach(d,function(e){var r=t[e];(_.isUndefined(r)||_.isEmpty(r))&&(s=s.replace(n(e),""))}),s=s.replace(/(\/)+$/,"")}}var o={},s=Restcase.Model,a=Restcase.Collection;return _.extend(a.prototype,Restcase.Events,t.collection),_.extend(s.prototype,Restcase.Events,t.model,{belongsTo:function(e,t){var r=this._relation(e,t);return new r},hasMany:function(e,t){var r=this._relation(e,t);return new r},_relation:function(e,t){if(_.isString(t)){var r=t;t={url:r}}if(_.isUndefined(t.url))throw new Error("You must specify an url");var n={modelId:this.get(this.idAttribute)};_.isUndefined(t.locals)||_.extend(n,t.locals);var o=e.extend({url:i(t.url)(n,{crop:!1})});return o},initialize:function(){var t=this,r=this.attributes;_.isFunction(this.url)&&this.url.apply(this),_.forEach(this.methods,function(n,o){var s={method:"GET",data:{},headers:{}};_.extend(s,n),this[o]=function(a,d){var u,c="save"===o,l=t.isNew();return _.isUndefined(d)&&(d={}),!c||l&&d.patch!==!0||(s.method="PATCH"),s.method=toUpperCase(s.method),angular.isDefined(n.url)?u=n.url:angular.isDefined(t.url)&&(u=t.url),s.url=i(u)(r),"POST"===s.method?_.extend(s.data,this.attributes):("PATCH"===s.method||"PUT"===s.method)&&angular.isDefined(a)&&_.extend(s.data,a),_.isObject(n.headers)&&_.extend(s.headers,n.headers),e(s).then(function(e){return e.data}).then(function(e){return _.isArray(e)||"fetch"!==o&&"save"!==o?(_.isArray(e)&&(e=e.map(function(e){var r=t.clone();return r.set(e),r})),e):(_.isObject(e)&&!_.isUndefined(e[t.idAttribute])&&t.set(e),t)})}},this)}}),o.Model=s,o.Collection=a,o.resolve=i,o}if(_.isUndefined(_))throw new Error("You must load underscore/lodash before load this module, aborting");if(_.isUndefined(Restcase))throw new Error("You must load Restcase before load this module, aborting");this.$get=e;var t=this.defaults={};this.defaults.model={idAttribute:"id",url:"",methods:{fetch:{method:"GET"},destroy:{method:"DELETE"},save:{method:"POST"}}},this.defaults.collection={},e.$inject=["$http","$parse"]}var url_resolve_regexp=/(?:\{)([^\/]*)+(?:\})/g;angular.module("victorqueiroz.ngRestcase",[]).provider("$restcase",$RestcaseProvider);
});